<!DOCTYPE html>
<html lang="en" ng-app="">
  <head>
    <meta charset="utf-8" />
    <meta name="token" content="" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Fastway Couriers currently operates across key metropolitan and regional locations across South Africa, offering a low cost and fast courier delivery service. Franchise opportunities also available."
    />
    <meta
      name="keywords"
      content="fastway, couriers, fastway couriers, courier, fastways, fastaway, freight, delivery, pickup, cheap, low cost, cost, economical, franchising, franchise opportunities, franchises, franchisee, business for sale, reliable, pick up, pick-up, van, woocommerce plugin, shopify plugin, ecwid plugin, ecommerce, best last mile courier, cheapest courier, best priced courier,"
    />
    <title>Fastway Couriers | Quick quote</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="css/fastway.css" />
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
  </head>
  <body>
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
    <!-- <script
      src="./scripts/jquery-ui-1.8.16.autocomplete.min.js"
      type="text/javascript"
    ></script> -->
    <div class="form-fluid">
      <div class="row m-2">
          <div class="col-md-4" >
              <div class="d-flex">
                <form action="" method="" >
                  <div class="input-group m-3 shadow">
                      <input type="search" class="form-control " placeholder="email" id="_email" value="demo@collivery.co.za" />
                      <input type="password" class="form-control " placeholder="password" id="_password" value="demo" />
                      <input type="button" class="btn btn-outline-dark" value="login"></input>
                  </div>
              </form>
                   
              </div>
          </div>
      </div>
    <!-- <link rel="stylesheet" href="./css/jquery-ui.css" type="text/css" /> -->
    <link rel="stylesheet" type="text/css" href="./css/quickquote.css" />
    <div class="section-quickquote paddTopBottom">
      <div class="container">
        <div class="col-sm-6">
          <div class="moduletable CFfranchiseForm">
            <div class="QuickQuoteformWrapper">
              <div class="QuickQuoteformHeader">
                <h1 style="color: #fff; text-align: center">Quick quote</h1>
                <h4 style="color: #fff; text-align: center">
                  (For Fastway customers)<br />Check the cost and delivery time
                  to get your parcel from A to B.
                </h4>
              </div>
              <div class="arrow-downBlue"></div>

              <div id="QuickQuoteform">
                <p style="font-size: 11px; text-align: right">
                  * Required fields
                </p>
                <form name="form">
                  <div class="col-md-2 m-3 shadow-lg p-2 border rounded" >
                    <div class="form-floating mb-3">
                        <input class="form-control" name="_collectionTownInput" list="_collectionTown" id="_collectionTownInput" placeholder="Type to search...">
                        <label for="_deliveryAddressInput" class="form-label">Collection: Suburb/Town</label>
                        <datalist id="_collectionTown"></datalist>
                    </div>
                    <div class="form-floating">
                        <input class="form-control mb-3" list="_deliveryTown" id="_deliveryTownInput" placeholder="Type to search...">
                        <label for="_deliveryContactInput" class="form-label">Delivery: Suburb/Town</label>
                        <datalist id="_deliveryTown"></datalist>
                    </div>
                  <label>Sending from*</label>

                  <select
                    class="form-control"
                    id="SendingFrom"
                    name="pFranchisee"
                  >
                    <option value="">Select location</option>
                    <option value="BFN">Bloemfontein</option>
                    <option value="CPT">Cape Town</option>
                    <option value="DUR">Durban</option>
                    <option value="ELS">East London</option>
                    <option value="GRJ">George</option>
                    <option value="JNB">Johannesburg</option>
                    <option value="KDP">Klerksdorp</option>
                    <option value="NLP">Nelspruit</option>
                    <option value="HRS">Newcastle</option>
                    <option value="PZB">Pietermaritzburg</option>
                    <option value="PTG">Polokwane</option>
                    <option value="PLZ">Port Elizabeth</option>
                    <option value="PRY">Pretoria</option>
                    <option value="RBG">Rustenburg</option>
                    <option value="VEE">Vereeniging</option>
                    <option value="WIT">Witbank</option>
                  </select>

                  <label>Sending to*</label>
                  <input
                    class="form-control"
                    id="SendingTo"
                    name="vTown"
                    type="text"
                  />

                  <div style="width: 30%; float: left; margin-right: 5%">
                    <label>Postcode*</label>
                    <input
                      class="form-control"
                      id="Postcode"
                      name="vPostcode"
                      maxlength="4"
                      type="text"
                    />
                  </div>

                  <div style="width: 30%; float: left; margin-right: 5%">
                    <label>Weight (kg)*</label>
                    <input
                      class="form-control"
                      id="Weight"
                      name="vWeight"
                      maxlength="3"
                      type="text"
                    />
                  </div>

                  <div style="clear: both">
                    <label style="font-size: 12px; padding-top: 12px"
                      >For the most accurate quote please enter the parcel
                      dimensions
                    </label>
                  </div>

                  <div style="width: 30%; float: left; margin-right: 5%">
                    <label>Length (cm)</label>
                    <input
                      class="form-control"
                      id="Length"
                      name="vLength"
                      maxlength="3"
                      type="text"
                    />
                  </div>

                  <div style="width: 30%; float: left; margin-right: 5%">
                    <label>Height (cm)</label>
                    <input
                      class="form-control"
                      id="Height"
                      name="vHeight"
                      maxlength="3"
                      type="text"
                    />
                  </div>

                  <div style="width: 30%; float: left">
                    <label>Width (cm)</label>
                    <input
                      class="form-control"
                      id="Width"
                      name="vWidth"
                      maxlength="3"
                      type="text"
                    />
                  </div>
                  <div class="checkboxWrapper">
                    <label class="checkbox">
                      <input
                        type="checkbox"
                        value="remember-me"
                        id="remember_me"
                        class="checkboxTick"
                      />
                      Remember search
                    </label>
                  </div>

                  <div style="padding-bottom: 6px">
                    <button
                      class="btn btn-primary btn-lg"
                      style="
                        margin-right: 6px;
                        margin-top: 12px;
                        width: 80%;
                        border-radius: 0px;
                      "
                      
                    >
                      Quote
                    </button>

                    <button
                      id="btnClear"
                      type="reset"
                      value="Reset"
                      class="btn btn-default btn-lg btn-clear"
                      style="border-radius: 0px; margin-top: 12px"
                    >
                      Clear
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
        <div id="app"></div>
        <div id="myData"></div>
      </div>
    </div>
     <script type="text/javascript">
//    function login()  {
//     const url = "https://api.collivery.co.za/v3/login"

// let body = {
//     "email":"demo@collivery.co.za",
//     "password":"demo"
// }
// fetch(url, {
//     method: "POST",
//     headers: {
//     "Content-Type": "application/json",
//     "Accept": "application/json",
//     "X-App-Name": "My Custom App",
//     "X-App-Version": "0.2.1",
//     "X-App-Host": ".NET Framework 4.8",
//     "X-App-Lang": "JAVASCRIPT",
//     "X-App-Url": "https://example.com",
// },
//     body:JSON.stringify({
//     email:"demo@collivery.co.za",
//     password:"demo"
// })
// })
//     .then(response => response.json())
//     .then((res) =>{
//       localStorage.setItem("token", res.data.api_token);

//       console.log(res)} 
    

//     );

//    }  
const { log } = console;
   // const credentials = JSON.stringify({ "email":"demo@collivery.co.za", "password":"demo" });
    const header ={ "Content-Type": "application/json","Accept": "application/json","X-App-Name": "SandBox App","X-App-Version": "1.0.0.0","X-App-Host": "ReactJS","X-App-Lang": "Javascript","X-App-Url": "https://oroafrica.com" }; 
    const server = (val)=> "https://api.collivery.co.za/v3/".concat(val);
     const parametrize =(url, params={})=> {params.api_token = $("meta[name='token']").attr("content"); return Object.keys(params).forEach(key=> url.searchParams.append(key,params[key]));};

      const api_key = "91d98ef3e489ee54f28ebfef8e6c6862";
      var form = document.forms["form"];
      form.onsubmit = async function (e) {
        e.preventDefault();
        const url = `https://sa.api.fastway.org/v3/psc/lookup?api_key=${api_key}`;
        const token = "OpSjx5TlXGCGkzGAvUOm";
        const result = await Promise.allSettled([
          fetch(url, {
            method: "POST",
            headers: {
              Accept: "application/json, text/plain, */*",
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              RFCode: document.form.pFranchisee.value,
              Suburb: document.form.vTown.value,
              DestPostcode: document.form.vPostcode.value,
              WeightInKg: document.form.vWeight.value,
            }),
          })
            .then((response) => response.json())
            .then((data) => {
              console.log(data);
              appendData(data.result.services);
            }),
          fetch("https://api.collivery.co.za/v3/quote?api_token=OpSjx5TlXGCGkzGAvUOm",{
            method: "POST",
             headers: {
             
              "Content-Type":"application/json","Accept": "application/json","X-App-Name": "SandBox App","X-App-Version": "1.0.0.0","X-App-Host": "ReactJS","X-App-Lang": "Javascript","X-App-Url": "https://oroafrica.com" 
            },
            body: JSON.stringify({
              parcels: [
                {
                  length: 21.5,
                  width: 10,
                  height: 5.5,
                  weight: 5.2,
                  quantity: 2,
                },
              ],
              collection_town: 147,
              delivery_town: 200,
              collection_location_type: 1,
              delivery_location_type: 5,
            }),
          })
            .then((response) => response.json())
            .then((res) => {
              console.log(res);
              appendDataCollivery(res.data);
            }),
        ])
        .catch((err) => {
          console.log(err);
        });
        // console.log(form);
      };
      function appendData(data) {
        var mainContainer = document.getElementById("myData");
        for (var i = 0; i < data.length; i++) {
          var div = document.createElement("div");
          div.innerHTML = `
                 <ul class="list-group mb-3">fastway
                 <li class="list-group-item">Country: ${data[i].type}  ${data[i].name} ${data[i].totalprice_frequent}</li>              </ul>
                `;
          mainContainer.appendChild(div);
        }
      }
      function appendDataCollivery(data) {
        var mainContainer = document.getElementById("myData");
        for (var i = 0; i < data.length; i++) {
          var div = document.createElement("div");
          div.innerHTML = `
                 <ul class="list-group mb-3"> collivery
                 <li class="list-group-item">Country: ${data[i].service_type}  ${data[i].delivery_type} ${data[i].total}</li>              </ul>
                `;
          mainContainer.appendChild(div);
        }
      }

      const apiCall=
    {
        login: async (creds=credentials)=>
        {
           let url = new URL(server("login"));
           return await fetch(url,{ method:"POST",headers:header,body:creds });
        }
        ,addressIndex: async (search="mds", customId="")=>
        {
           let url = new URL(server("address"));
           parametrize(url,{"search":search,custom_id:customId,"include":"contacts" }); //search|custom_id 
           return await fetch(url,{ method:"GET",headers:header });
        }
        ,addressId: async (addressId="0")=>
        {
           let url = new URL(server(`address/${addressId}`));
           parametrize(url,{"include":"contacts" });
           return await fetch(url,{ method:"GET",headers:header });
        }
        ,addressSave:async (body={})=>
        {
            let url = new URL(server("address"));
            parametrize(url);
            return await fetch(url,{ method:"POST",headers:header,body:JSON.stringify(body) });
        }
        ,addressUpdate:async (body={},addressId="")=>
        {
            let url = new URL(server(`address/${addressId}`));
            parametrize(url); 
           return await fetch(url,{ method:"PUT",headers:header,body:JSON.stringify(body) });
        }
        ,addressDelete:async (addressId="0")=>
        {
            let url = new URL(server(`address/${addressId}`));
            parametrize(url); 
            return await fetch(url,{ method:"DELETE",headers:header });
        }
        ,addressDefault:async ()=>
        {
            let url = new URL(server("default_address"));
            parametrize(url); 
           return await fetch(url,{ method:"GET",headers:header });
        }
        ,contactIndex:async (search="mds",addressId="")=>
        {
            let url = new URL(server("contacts"));
            parametrize(url,{ "search":search,address_id:addressId});  //address_id | search
            return await fetch(url,{ method:"GET",headers:header });
        }
        ,contactSave:async (body={})=>
        {
            let url = new URL(server("contacts"));
            parametrize(url); 
           return await fetch(url,{ method:"POST",headers:header,body:JSON.stringify(body) });
        }
        ,contactShow:async (contactId="")=>
        {
            let url = new URL(server(`contacts/${contactId}`));
            parametrize(url); 
           return await fetch(url,{ method:"GET",headers:header });
        }
        ,contactUpdate:async (contactId="")=>
        {
            let url = new URL(server(`contacts/${contactId}`));
            parametrize(url); 
            let body = 
            {
                "address_id": "3722446",
                "email": "world@example.com",
                "full_name": "Sandra banks",
                "cellphone": "0721234567"
                ,"work_phone": "0214242000"
            };
            
           return await fetch(url,{ method:"PUT",headers:header,body:JSON.stringify(body) });
        }
        ,contactDelete:async (contactId="0")=>
        {
            let url = new URL(server(`contacts/${contactId}`));
            parametrize(url); 
           return await fetch(url,{ method:"DELETE",headers:header });
        }
        ,addressTown:async (town="")=>
        {
            let url = new URL(server("towns"));
            parametrize(url,{ "search": town }); 
           return await fetch(url,{ method:"GET",headers:header });
        }
        ,addressSuburbs:async (suburb="",postalCode="",country="ZAF")=>
        {
            let url = new URL(server("suburbs"));
            parametrize(url,{ "search": suburb,postal_code:postalCode, country:country});
            return await fetch(url,{ method:"GET",headers:header });
        }
        ,addressSuburbsId:async (id="",country="ZAF")=>
        {
            let url = new URL(server(`suburbs/${id}`));
            parametrize(url,{ country:country }); 
            return await fetch(url,{ method:"GET",headers:header });
        }
        ,addressTownSuburbs:async (search="cape town")=>
        {
            let url = new URL(server(`town_suburb_search`));
            parametrize(url,{ search_text:search }); 
            return await fetch(url,{ method:"GET",headers:header });
        }
        ,serviceTypes:async ()=>
        {
            let url = new URL(server(`service_types`));
            parametrize(url); 
            return await fetch(url,{ method:"GET",headers:header });
        }
        ,serviceTypes:async ()=>
        {
            let url = new URL(server(`service_types`));
            parametrize(url); 
            return await fetch(url,{ method:"GET",headers:header });
        }
        ,
    };
    const actions =
    {
        login:()=>
        {
            $(document).on("click","input:button",(ev)=>
            {
       

                let _fail = ()=>{ alert("Login Failed");};
                let _success = (d)=>{$("meta[name='token']").attr("content",d.data.api_token); $(".onAuth").removeClass("d-none");};
                if (ev.target.value === "login" ) 
                {
                    if(!$("meta[name='token']").attr("content"))
                    {
                        apiCall.login(JSON.stringify({ "email":$("#_email").val(), "password":$("#_password").val() }))
                        .then(resp=> (resp.ok) ? resp.json() : "error")
                        .then(d=> (d === "error") ? _fail() : _success(d));                       
                    }
                    else if($("meta[name='token']").attr("content"))
                    {
                        $(".onAuth").removeClass("d-none");
                    }
                };
            });
        },
        collectionPoint:()=>
        {
   

            $(document).on("keyup","#_collectionTownInput",(ev)=>
            {
                apiCall.addressTownSuburbs($("#_collectionTownInput").val())
                    .then(resp=> resp.json())
                    .then(d=> 
                    {
                       if (!d.data | $("#_collectionTownInput").val() < 4) return;
                        $("#_collectionTown").html("");
                       
                        d.data.slice(0,20).map(k=>
                        {
                            $("#_collectionTown").append(`<option id="onme" >`.concat(k.formatted_result).concat("</option>"));
                        });
                    });
            });
        }
        ,deliveryPoint:()=>
        {
   

            $(document).on("keyup","#_deliveryTownInput",(ev)=>
            {
                apiCall.addressTownSuburbs($("#_deliveryTownInput").val())
                    .then(resp=> resp.json())
                    .then(d=> 
                    {
                        if (!d.data | $("#_deliveryTownInput").val() < 4) return;
                        $("#_deliveryTown").html("");
                       
                        d.data.slice(0,20).map(k=>
                        {
                            $("#_deliveryTown").append(`<option id="onme" >`.concat(k.formatted_result).concat("</option>"));
                        });
                    });
            });
        }
        ,resetQuote:()=>
        {
   

            $(document).on("click","input:button",(ev)=>
            {
                if (ev.target.value === "reset" ) 
                {
                    $("#_collectionTownInput").val("");
                    $("#_deliveryTownInput").val("");
                    $("#deliveryType").prop("selectedIndex",0);
                    $(".qbox").html("");
                }
            });    
        }
        ,packageSize:()=>
        {

        }
        // ,getQuote:()=>
        // {
        //     $(document).click("click","input:button",(ev)=>
        //     {
        //         if (ev.target.value === "quotes" ) 
        //         {
        //             //get collection town id
        //             const _collectAddress = apiCall.addressTownSuburbs($("#_collectionTownInput").val().split(",")[0])
        //                         .then(resp=> resp.json())
        //                         .then(d=> 
        //                         {
        //                             log("COLLECTION: ",d.data[0].suburb.name + " - " + d.data[0].suburb.town.name);
        //                             return { suburbId:d.data[0].suburb.id, townId:d.data[0].suburb.town.id};
        //                         });
        //             //get delivery town id
        //             const _deliverAddress = apiCall.addressTownSuburbs($("#_deliveryTownInput").val().split(",")[0])
        //                         .then(resp=> resp.json())
        //                         .then(d=> 
        //                         {
        //                             log("DELIVER: ",d.data[0].suburb.name + " - " + d.data[0].suburb.town.name);
        //                             return { suburbId:d.data[0].suburb.id, townId:d.data[0].suburb.town.id};
        //                         });
        //             //get quote
        //             Promise.all([_collectAddress,_deliverAddress])
        //                     .then(val=> 
        //                     {
        //                         //get parcel info
        //                         var _parcel = parcelSizes($("#deliveryType").val());
        //                         let quot =
        //                         {
        //                             /* optional/improvised parameters
        //                             "services": [2],
        //                             "parcels": [{"length": 21.5,"width": 10,"height": 5.5,"weight": 5.2,"quantity": 1}],
        //                             "collection_town": 147,
        //                             "collection_time": "2025-01-24T12:00",
        //                             "delivery_time": "2025-01-25T16:00:00" 
        //                             "delivery_town": 200,
        //                              */
        //                             "parcels": [_parcel],
        //                             "collection_town": val[0].townId,
        //                             "delivery_town": val[1].townId,
        //                             "collection_location_type": 1,
        //                             "delivery_location_type": 5
        //                         };
        //                         apiCall.requestQuote(quot)
        //                                 .then(res=> res.json())
        //                                 .then(d=> 
        //                                 {
        //                                     $(".qbox").html("");
        //                                     d.data.map((val)=>
        //                                     {
        //                                         let parent = $("<div class='form-floating mb-3 _qval' />");
        //                                         let total = $(`<input type='text' class='form-control' placeholder='header' id=${deliveryTypes(val.service_type)} value='R ${val.total}' />`);
        //                                         let label = $(`<label class='form-label' for=${deliveryTypes(val.service_type)} > ${deliveryTypes(val.service_type)} : ${val.delivery_type}</label>`);
        //                                         parent.append(total,label);
        //                                         $(".qbox").append(parent);
        //                                     });
        //                                     //remove mb-3 to avoid margin overhang
        //                                     $("._qval").last().removeClass("mb-3");
        //                                 });
        //                     });
               // }
           // });    
       // }
    };
     
    /* EXE */
    Object.values(actions).forEach(v=> v());

    </script>
  </body>
</html>
